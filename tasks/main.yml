# file: tasks/emacs.yml

- name: EMACS | clean tmp dir
  file:
    state: absent
    path: "{{ emacs_tmp }}"

- name: EMACS | get emacs from git repository
  git: repo={{ emacs_repo_url }}
       dest="{{ emacs_tmp }}"
       version={{ emacs_version }}
  register: emacs_downloaded

- name: EMACS | make emacs configure file
  command: ./autogen.sh chdir="{{ emacs_tmp }}"
  when: emacs_downloaded.changed

- name: EMACS | make emacs Makefile
  command: ./configure --prefix=/usr/local
           --without-makeinfo --with-x-toolkit=no --without-x
           --without-all
           chdir="{{ emacs_tmp }}"
  when: emacs_downloaded.changed

- name: EMACS | make emacs
  command: make chdir="{{ emacs_tmp }}"
  when: emacs_downloaded.changed

- name: EMACS | install emacs
  command: make install chdir="{{ emacs_tmp }}"
  become: true
  when: emacs_downloaded.changed
